{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sychen/thesis-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sychen/thesis-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sychen/thesis-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import Jumbotron from'../Jumbotron';import styled from'styled-components';import{ethers}from\"ethers\";import{Contract}from\"@ethersproject/contracts\";import{RINKEBY_ID,addresses,abis}from\"@uniswap-v2-app/contracts\";import{Link as RouterLink}from'react-router-dom';import Link from\"@material-ui/core/Link\";import{makeStyles}from'@material-ui/core/styles';import Container from'@material-ui/core/Container';import Card from'@material-ui/core/Card';import CardActions from'@material-ui/core/CardActions';import CardContent from'@material-ui/core/CardContent';import Button from'@material-ui/core/Button';import Typography from'@material-ui/core/Typography';import Grid from'@material-ui/core/Grid';export default function StakePage(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),policies=_useState2[0],setPolicies=_useState2[1];useEffect(function(){var getPolicies=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var policy,summary,provider,policyFactoryContract,policies,allPolicies;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:provider=new ethers.providers.Web3Provider(window.ethereum);policyFactoryContract=new Contract(addresses[RINKEBY_ID].policyFactory,abis.policyFactory,provider);_context.next=4;return policyFactoryContract.getDeloyedPolicies();case 4:policies=_context.sent;console.log(policies);_context.next=8;return Promise.all(policies.map(function(address,index){policy=new Contract(address,abis.policy,provider);return policy.getSummary();}));case 8:allPolicies=_context.sent;setPolicies(allPolicies);case 10:case\"end\":return _context.stop();}}},_callee);}));return function getPolicies(){return _ref.apply(this,arguments);};}();getPolicies();},[]);function renderList(policies){if(policies==0){return/*#__PURE__*/React.createElement(\"div\",null,\"Loading...\");}return Object.values(policies).map(function(element,idx){console.log(element);return/*#__PURE__*/React.createElement(Grid,{key:idx,item:true,xs:4},/*#__PURE__*/React.createElement(Card,{variant:\"outlined\"},/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(Typography,{color:\"textSecondary\",gutterBottom:true}),/*#__PURE__*/React.createElement(Typography,{variant:\"h5\",component:\"h2\"},element[0]),/*#__PURE__*/React.createElement(Typography,{color:\"textSecondary\"},/*#__PURE__*/React.createElement(Link,{href:\"https://ipfs.io/ipfs/\".concat(element[2]),rel:\"noopener\",target:\"_blank\",style:{textDecoration:'none'}},element[2])),/*#__PURE__*/React.createElement(Typography,{color:\"textSecondary\"},\"Insurance base: \",/*#__PURE__*/React.createElement(\"span\",{style:{float:'right'}},element[1].toString()/Math.pow(10,18),\" Ether\")),/*#__PURE__*/React.createElement(Typography,{color:\"textSecondary\"},\"Stacked: \",/*#__PURE__*/React.createElement(\"span\",{style:{float:'right'}},element[3].toString()/Math.pow(10,18),\" SYC\"))),/*#__PURE__*/React.createElement(CardActions,null,/*#__PURE__*/React.createElement(Button,{component:RouterLink,to:\"/staking/\".concat(idx),variant:\"contained\",color:\"primary\"},\"Stack\"),/*#__PURE__*/React.createElement(Button,{component:RouterLink,to:\"/claims/\".concat(idx),variant:\"contained\",color:\"secondary\"},\"Request\"),/*#__PURE__*/React.createElement(Button,{component:RouterLink,to:\"/stakeholders/\".concat(idx),variant:\"contained\",color:\"secondary\"},\"Stakeholders\"))));});}return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Jumbotron,{title:\"Stake\",description:\"Earn rewards by staking SYC on policies you want to engage.\"}),/*#__PURE__*/React.createElement(Container,{style:{marginTop:\"20px\"}},/*#__PURE__*/React.createElement(Grid,{container:true,style:{marginTop:\"20px\"},spacing:5},renderList(policies))));}","map":{"version":3,"sources":["/Users/sychen/thesis-app/packages/react-app/src/components/Pages/StakePage.js"],"names":["React","useState","useEffect","Jumbotron","styled","ethers","Contract","RINKEBY_ID","addresses","abis","Link","RouterLink","makeStyles","Container","Card","CardActions","CardContent","Button","Typography","Grid","StakePage","policies","setPolicies","getPolicies","provider","providers","Web3Provider","window","ethereum","policyFactoryContract","policyFactory","getDeloyedPolicies","console","log","Promise","all","map","address","index","policy","getSummary","allPolicies","renderList","Object","values","element","idx","textDecoration","float","toString","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Jumbotron from '../Jumbotron';\nimport styled from 'styled-components';\nimport { ethers } from \"ethers\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport { RINKEBY_ID, addresses, abis } from \"@uniswap-v2-app/contracts\";\nimport { Link as RouterLink } from 'react-router-dom';\nimport Link from \"@material-ui/core/Link\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Container from '@material-ui/core/Container';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\n\n\nexport default function StakePage() {\n    const [policies, setPolicies] = useState(0);\n\n    useEffect(() => {\n        const getPolicies = async () => {\n            let policy, summary;\n            const provider = new ethers.providers.Web3Provider(window.ethereum);\n            const policyFactoryContract = new Contract(addresses[RINKEBY_ID].policyFactory, abis.policyFactory, provider);\n            const policies = await policyFactoryContract.getDeloyedPolicies();\n            console.log(policies)\n            const allPolicies = await Promise.all(\n                policies\n                    .map((address, index) => {\n                        policy = new Contract(address, abis.policy, provider);\n                        return policy.getSummary();\n                    }));\n\n            setPolicies(allPolicies);\n        }\n        getPolicies();\n    }, []);\n\n    function renderList(policies) {\n        if (policies == 0) {\n            return <div>Loading...</div>\n        }\n        return Object.values(policies).map((element, idx) => {\n            console.log(element)\n            return (\n                <Grid key={idx} item xs={4}>\n                    <Card variant=\"outlined\">\n                <CardContent>\n                  <Typography color=\"textSecondary\" gutterBottom>\n                  </Typography>\n                  <Typography variant=\"h5\" component=\"h2\">\n                    {element[0]}\n                  </Typography>\n                  <Typography color=\"textSecondary\">\n                    <Link href={`https://ipfs.io/ipfs/${element[2]}`} rel=\"noopener\" target=\"_blank\" style={{ textDecoration: 'none' }}>\n                        {element[2]}\n                    </Link>\n                  </Typography>\n                  <Typography color=\"textSecondary\">\n                    Insurance base: <span style={{float: 'right'}}>{element[1].toString() / 10**18} Ether</span>\n                  </Typography>\n                  <Typography color=\"textSecondary\">\n                    Stacked: <span style={{float: 'right'}}>{element[3].toString() / 10**18} SYC</span>\n                  </Typography>\n\n                </CardContent>\n                <CardActions>\n                    <Button component={ RouterLink } to={`/staking/${idx}`} variant=\"contained\" color=\"primary\">\n                        Stack\n                    </Button>\n                    <Button component={ RouterLink } to={`/claims/${idx}`} variant=\"contained\" color=\"secondary\">\n                        Request\n                    </Button>\n                    <Button component={ RouterLink } to={`/stakeholders/${idx}`} variant=\"contained\" color=\"secondary\">\n                        Stakeholders\n                    </Button>\n                </CardActions>\n              </Card>\n                </Grid>\n            \n            );\n        })\n\n    }\n\n\n    return (\n        <div>\n            <Jumbotron\n                title=\"Stake\"\n                description=\"Earn rewards by staking SYC on policies you want to engage.\" />\n            <Container style={{ marginTop: \"20px\" }}>\n                <Grid container style={{ marginTop: \"20px\" }} spacing={5}>\n                    {renderList(policies)}\n                </Grid>\n            </Container>\n\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}