{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sychen/thesis-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sychen/thesis-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sychen/thesis-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{RINKEBY_ID,addresses,abis}from\"@uniswap-v2-app/contracts\";import{Contract}from\"@ethersproject/contracts\";import{ethers}from\"ethers\";import styled from'styled-components';import{ChainId,Token,WETH,Fetcher,Route}from'@uniswap/sdk';import Container from'@material-ui/core/Container';import Card from'@material-ui/core/Card';import CardContent from'@material-ui/core/Card';import{makeStyles}from'@material-ui/core/styles';import Grid from'@material-ui/core/Grid';import TextField from'@material-ui/core/TextField';import Icon from'@material-ui/core/Icon';import Typography from'@material-ui/core/Typography';import CardActions from'@material-ui/core/CardActions';import{Button,CircularProgress}from'@material-ui/core';import axios from'axios';// const projectId = \"66fbccb2856b40b3a622d925568379e9\";\n// const projectSecret = \"275ed56f36e440e0ab7cad94a3310aae\";\nvar useStyles=makeStyles(function(theme){return{container:{marginTop:\"20px\"},root:{},CardContent:{backgroundColor:'#FFFFFF',paddingTop:'2rem',padding:'0px 2rem 2rem'},GridContainer:{padding:'0px 30px 30px 0px'},bullet:{display:'inline-block',margin:'0 2px',transform:'scale(0.8)'},title:{fontSize:14,fontWeight:'600'},pos:{marginBottom:12,align:'right'},FormContent:{padding:'0.5rem 1rem',marginBottom:'1rem',borderRadius:'1rem',width:'100%',border:'1px solid rgb(228, 232, 239)',color:'rgb(80, 80, 80)',boxShadow:'rgb(0 0 0 / 4%) 0px 1px 6px inset'},disabledFormContent:{padding:'0.5rem 1rem',marginBottom:'1rem',borderRadius:'1rem',width:'100%',border:'1px solid rgb(228, 232, 239)',color:'rgb(80, 80, 80)',boxShadow:'rgb(0 0 0 / 4%) 0px 1px 6px inset',background:'rgb(228, 232, 239)'},symbol:{fontSize:'1.5rem'},max:{display:'inline',opacity:'1',lineHeight:'1rem',color:'rgb(96, 211, 162)',cursor:'pointer'},currencyInput:{padding:'1rem 1rem 1rem 0px',textAlign:'right',border:'none',fontSize:'1.5rem',fontWeight:'400',width:'100%',boxSizing:'border-box',appearance:'none',outline:'none',\"&:focus\":{outline:'none !important'}},swapButton:{color:'#24947A',borderColor:'#24947A',borderRadius:'50px',float:'right',width:'100px',fontSize:'14px',loading:''}};});export default function CurrencyInputPanel(){var classes=useStyles();var provider=new ethers.providers.Web3Provider(window.ethereum);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),ETHAmount=_useState2[0],setETHAmount=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),SYCAmount=_useState4[0],setSYCAmount=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),SYCPrice=_useState6[0],setSYCPrice=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),ETHPrice=_useState8[0],setETHPrice=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loading=_useState10[0],setLoading=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),totoken=_useState12[0],setTotoken=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),approveAlready=_useState14[0],setApproveAlready=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),networkId=_useState16[0],setNetworkId=_useState16[1];useEffect(function(){function getNetworkId(){return _getNetworkId.apply(this,arguments);}function _getNetworkId(){_getNetworkId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var provider,networkId;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:provider=new ethers.providers.Web3Provider(window.ethereum);_context.next=3;return provider.getNetwork();case 3:networkId=_context.sent;setNetworkId(networkId.chainId);case 5:case\"end\":return _context.stop();}}},_callee);}));return _getNetworkId.apply(this,arguments);}function getApproveState(){return _getApproveState.apply(this,arguments);}function _getApproveState(){_getApproveState=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var SycContract,account,approveState;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:SycContract=new Contract(addresses[RINKEBY_ID].tokens.SYC,abis.erc20.abi,provider);_context2.next=3;return provider.listAccounts();case 3:account=_context2.sent;_context2.next=6;return SycContract.allowance(account[0],addresses[RINKEBY_ID].implementation);case 6:approveState=_context2.sent;approveState.gte('5742700000000000000000000')?setApproveAlready(true):setApproveAlready(false);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return _getApproveState.apply(this,arguments);}getNetworkId();getApproveState();},[]);useEffect(function(){var fetchPrice=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(!isNaN(ETHAmount)&&ETHAmount&&totoken)){_context3.next=8;break;}_context3.t0=setSYCAmount;_context3.next=4;return getPairAmount();case 4:_context3.t1=_context3.sent;(0,_context3.t0)(_context3.t1);_context3.next=17;break;case 8:if(!(!isNaN(SYCAmount)&&SYCAmount&&!totoken)){_context3.next=16;break;}_context3.t2=setETHAmount;_context3.next=12;return getPairAmount();case 12:_context3.t3=_context3.sent;(0,_context3.t2)(_context3.t3);_context3.next=17;break;case 16:if(ETHAmount===''||SYCAmount===''){setSYCAmount('');setETHAmount('');}case 17:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchPrice(){return _ref.apply(this,arguments);};}();fetchPrice();},[ETHAmount,SYCAmount,totoken]);useEffect(function(){var getETHPrice=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var priceInfo;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return axios.get('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT');case 2:priceInfo=_context4.sent;setETHPrice(priceInfo.data.price);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function getETHPrice(){return _ref2.apply(this,arguments);};}();var getSYCPrice=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var SycWethExchangeContract,reserves,k,y,x,_y,_x;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:SycWethExchangeContract=new Contract(addresses[RINKEBY_ID].pairs[\"SYC-WETH\"],abis.pair,provider);_context5.next=3;return SycWethExchangeContract.getReserves();case 3:reserves=_context5.sent;// reserves[0] is ETHER, reserves[1] is SYCoin\nk=reserves[0].mul(reserves[1]);if(totoken){y=ethers.utils.parseUnits('0.997',\"ether\").add(reserves[0]);x=ethers.utils.formatEther(reserves[1].sub(k.div(y)));setSYCPrice(x.toString());}else{_y=ethers.utils.parseUnits('0.997',\"ether\").add(reserves[1]);_x=ethers.utils.formatEther(reserves[0].sub(k.div(_y)));setSYCPrice(_x.toString());}case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function getSYCPrice(){return _ref3.apply(this,arguments);};}();getETHPrice();getSYCPrice();},[totoken]);function getPairAmount(){return _getPairAmount.apply(this,arguments);}function _getPairAmount(){_getPairAmount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var SycWethExchangeContract,reserves,k,ETHAmountSubFee,SYCAmountSubFee,x,y;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;SycWethExchangeContract=new Contract(addresses[RINKEBY_ID].pairs[\"SYC-WETH\"],abis.pair,provider);_context6.next=4;return SycWethExchangeContract.getReserves();case 4:reserves=_context6.sent;// reserves[0] is SYC, reserves[1] is ETHER\nk=reserves[0].mul(reserves[1]);// fee to dev 0.3%\nif(totoken){ETHAmountSubFee=(parseFloat(ETHAmount)*0.997).toString();y=ethers.utils.parseUnits(ETHAmountSubFee,\"ether\").add(reserves[0]);x=ethers.utils.formatEther(reserves[1].sub(k.div(y)));}else{SYCAmountSubFee=(parseFloat(SYCAmount)*0.997).toString();y=ethers.utils.parseUnits(SYCAmountSubFee,\"ether\").add(reserves[1]);x=ethers.utils.formatEther(reserves[0].sub(k.div(y)));}return _context6.abrupt(\"return\",x.toString());case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);console.log(_context6.t0);case 13:case\"end\":return _context6.stop();}}},_callee6,null,[[0,10]]);}));return _getPairAmount.apply(this,arguments);}function changeDirection(){setTotoken(!totoken);setSYCAmount('');setETHAmount('');}function onSwap(){return _onSwap.apply(this,arguments);}function _onSwap(){_onSwap=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var tx,signer,implemetationContract;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;setLoading(true);signer=provider.getSigner();implemetationContract=new Contract(addresses[RINKEBY_ID].implementation,abis.implemetation,signer);if(!totoken){_context7.next=10;break;}_context7.next=7;return implemetationContract.swapETHToSyc({value:ethers.utils.parseEther(ETHAmount)});case 7:tx=_context7.sent;_context7.next=13;break;case 10:_context7.next=12;return implemetationContract.swapSycForETH(ethers.utils.parseEther(SYCAmount));case 12:tx=_context7.sent;case 13:_context7.next=15;return provider.waitForTransaction(tx.hash);case 15:setLoading(false);console.log(tx);_context7.next=22;break;case 19:_context7.prev=19;_context7.t0=_context7[\"catch\"](0);console.log(_context7.t0);case 22:setLoading(false);case 23:case\"end\":return _context7.stop();}}},_callee7,null,[[0,19]]);}));return _onSwap.apply(this,arguments);}function onApprove(){return _onApprove.apply(this,arguments);}function _onApprove(){_onApprove=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var signer,erc20Contract,tx;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;setLoading(true);signer=provider.getSigner();erc20Contract=new Contract(addresses[RINKEBY_ID].tokens.SYC,abis.erc20.abi,signer);_context8.next=6;return erc20Contract.approve(addresses[RINKEBY_ID].implementation,'0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff');case 6:tx=_context8.sent;_context8.next=9;return provider.waitForTransaction(tx.hash);case 9:setLoading(false);setApproveAlready(true);_context8.next=16;break;case 13:_context8.prev=13;_context8.t0=_context8[\"catch\"](0);console.log(_context8.t0);case 16:setLoading(false);case 17:case\"end\":return _context8.stop();}}},_callee8,null,[[0,13]]);}));return _onApprove.apply(this,arguments);}function onMax(){return _onMax.apply(this,arguments);}function _onMax(){_onMax=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var signer,account,balance;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:signer=provider.getSigner();_context9.next=3;return signer.getAddress();case 3:account=_context9.sent;_context9.next=6;return provider.getBalance(account);case 6:balance=_context9.sent;setETHAmount(ethers.utils.formatEther(balance.toString()));case 8:case\"end\":return _context9.stop();}}},_callee9);}));return _onMax.apply(this,arguments);}if(totoken){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Container,{className:classes.container,maxWidth:\"lg\"},/*#__PURE__*/React.createElement(Card,{className:classes.root},/*#__PURE__*/React.createElement(CardContent,{className:classes.CardContent},/*#__PURE__*/React.createElement(Grid,{container:true,className:classes.GridContainer,spacing:10},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:5},/*#__PURE__*/React.createElement(Card,{className:classes.FormContent},/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",justifyContent:'space-between'}},/*#__PURE__*/React.createElement(Typography,{className:classes.title,color:\"textPrimary\"},\"Amount\"),/*#__PURE__*/React.createElement(Button,{className:classes.max,onClick:function onClick(e){onMax();}},\"Max\")),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\"}},/*#__PURE__*/React.createElement(\"input\",{className:classes.currencyInput,placeholder:\"0\",onChange:function onChange(e){return setETHAmount(e.target.value);},value:ETHAmount}),/*#__PURE__*/React.createElement(Button,{align:\"right\",className:classes.symbol,display:\"inlign\"},\"ETH\")),/*#__PURE__*/React.createElement(Typography,{className:classes.pos,color:\"textSecondary\",align:\"right\"},\"~$\",(ETHPrice*ETHAmount).toFixed(2)))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:2},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'center',height:'100%'}},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-exchange-alt fa-2x\",onClick:function onClick(e){return changeDirection(false);},style:{cursor:'pointer'}}))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:5,style:{cursor:'not-allowed'}},/*#__PURE__*/React.createElement(Card,{className:classes.disabledFormContent},/*#__PURE__*/React.createElement(\"div\",{disabled:true,style:{display:\"flex\"}},/*#__PURE__*/React.createElement(Typography,{className:classes.title,color:\"textPrimary\"},\"Amount to be received (estimated)\")),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\"}},/*#__PURE__*/React.createElement(\"input\",{className:classes.currencyInput,disabled:true,style:{cursor:'not-allowed',background:'rgb(228, 232, 239)'},value:SYCAmount}),/*#__PURE__*/React.createElement(Button,{align:\"right\",className:classes.symbol,display:\"inlign\"},\"SYC\")),/*#__PURE__*/React.createElement(Typography,{className:classes.pos,color:\"textSecondary\",align:\"right\"},SYCAmount?\"\".concat(parseFloat(SYCAmount/ETHAmount).toFixed(3),\" SYC per ETH\"):'🤔 SYC per ETH')))),/*#__PURE__*/React.createElement(\"div\",{style:{'marginRight':'0'}},/*#__PURE__*/React.createElement(Button,{variant:\"outlined\",className:classes.swapButton,onClick:function onClick(e){return onSwap();}},loading&&/*#__PURE__*/React.createElement(CircularProgress,{size:14}),!loading&&'SWAP'))))));}else{return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Container,{className:classes.container,maxWidth:\"lg\"},/*#__PURE__*/React.createElement(Card,{className:classes.root},/*#__PURE__*/React.createElement(CardContent,{className:classes.CardContent},/*#__PURE__*/React.createElement(Grid,{container:true,className:classes.GridContainer,spacing:10},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:5},/*#__PURE__*/React.createElement(Card,{className:classes.FormContent},/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",justifyContent:'space-between'}},/*#__PURE__*/React.createElement(Typography,{className:classes.title,color:\"textPrimary\"},\"Amount\"),/*#__PURE__*/React.createElement(Button,{className:classes.max,onClick:function onClick(e){onMax();}},\"Max\")),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\"}},/*#__PURE__*/React.createElement(\"input\",{className:classes.currencyInput,placeholder:\"0\",onChange:function onChange(e){return setSYCAmount(e.target.value);},value:SYCAmount}),/*#__PURE__*/React.createElement(Button,{align:\"right\",className:classes.symbol,display:\"inlign\"},\"SYC\")),/*#__PURE__*/React.createElement(Typography,{className:classes.pos,color:\"textSecondary\",align:\"right\"},\"~$\",ETHAmount?\"\".concat((ETHAmount/SYCAmount*ETHPrice).toFixed(2)):'0.00'))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:2},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'center',height:'100%'}},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-exchange-alt fa-2x\",onClick:function onClick(e){return changeDirection(false);},style:{cursor:'pointer'}}))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:5,style:{cursor:'not-allowed'}},/*#__PURE__*/React.createElement(Card,{className:classes.disabledFormContent},/*#__PURE__*/React.createElement(\"div\",{disabled:true,style:{display:\"flex\"}},/*#__PURE__*/React.createElement(Typography,{className:classes.title,color:\"textPrimary\"},\"Amount to be received (estimated)\")),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\"}},/*#__PURE__*/React.createElement(\"input\",{className:classes.currencyInput,disabled:true,style:{cursor:'not-allowed',background:'rgb(228, 232, 239)'},value:ETHAmount}),/*#__PURE__*/React.createElement(Button,{align:\"right\",className:classes.symbol,display:\"inlign\"},\"ETH\")),/*#__PURE__*/React.createElement(Typography,{className:classes.pos,color:\"textSecondary\",align:\"right\"},ETHAmount?\"\".concat(parseFloat(ETHAmount/SYCAmount).toFixed(6),\" ETH per SYC\"):'🤔 ETH per SYC')))),/*#__PURE__*/React.createElement(\"div\",{style:{marginRight:'0'}},/*#__PURE__*/React.createElement(Button,{variant:\"outlined\",className:classes.swapButton,onClick:function onClick(e){return onSwap();},disabled:!approveAlready},\"SWAP\"),/*#__PURE__*/React.createElement(Button,{style:{marginRight:'10px'},variant:\"outlined\",className:classes.swapButton,onClick:function onClick(e){return onApprove();},disabled:approveAlready},\"Approve\"))))));}}","map":{"version":3,"sources":["/Users/sychen/thesis-app/packages/react-app/src/components/CurrencyInputPanel/index.js"],"names":["React","useState","useEffect","RINKEBY_ID","addresses","abis","Contract","ethers","styled","ChainId","Token","WETH","Fetcher","Route","Container","Card","CardContent","makeStyles","Grid","TextField","Icon","Typography","CardActions","Button","CircularProgress","axios","useStyles","theme","container","marginTop","root","backgroundColor","paddingTop","padding","GridContainer","bullet","display","margin","transform","title","fontSize","fontWeight","pos","marginBottom","align","FormContent","borderRadius","width","border","color","boxShadow","disabledFormContent","background","symbol","max","opacity","lineHeight","cursor","currencyInput","textAlign","boxSizing","appearance","outline","swapButton","borderColor","float","loading","CurrencyInputPanel","classes","provider","providers","Web3Provider","window","ethereum","ETHAmount","setETHAmount","SYCAmount","setSYCAmount","SYCPrice","setSYCPrice","ETHPrice","setETHPrice","setLoading","totoken","setTotoken","approveAlready","setApproveAlready","networkId","setNetworkId","getNetworkId","getNetwork","chainId","getApproveState","SycContract","tokens","SYC","erc20","abi","listAccounts","account","allowance","implementation","approveState","gte","fetchPrice","isNaN","getPairAmount","getETHPrice","get","priceInfo","data","price","getSYCPrice","SycWethExchangeContract","pairs","pair","getReserves","reserves","k","mul","y","utils","parseUnits","add","x","formatEther","sub","div","toString","ETHAmountSubFee","parseFloat","SYCAmountSubFee","console","log","changeDirection","onSwap","signer","getSigner","implemetationContract","implemetation","swapETHToSyc","value","parseEther","tx","swapSycForETH","waitForTransaction","hash","onApprove","erc20Contract","approve","onMax","getAddress","getBalance","balance","justifyContent","e","target","toFixed","alignItems","height","marginRight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { RINKEBY_ID, addresses, abis } from \"@uniswap-v2-app/contracts\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport { ethers } from \"ethers\";\nimport styled from 'styled-components';\nimport { ChainId, Token, WETH, Fetcher, Route } from '@uniswap/sdk'\nimport Container from '@material-ui/core/Container';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/Card';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\nimport CardActions from '@material-ui/core/CardActions';\nimport { Button, CircularProgress } from '@material-ui/core';\nimport axios from 'axios';\n\n\n\n// const projectId = \"66fbccb2856b40b3a622d925568379e9\";\n// const projectSecret = \"275ed56f36e440e0ab7cad94a3310aae\";\n\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    marginTop: \"20px\",\n  },\n  root: {\n  },\n  CardContent: {\n    backgroundColor: '#FFFFFF',\n    paddingTop: '2rem',\n    padding: '0px 2rem 2rem'\n  },\n  GridContainer: {\n    padding: '0px 30px 30px 0px'\n  },\n  bullet: {\n    display: 'inline-block',\n    margin: '0 2px',\n    transform: 'scale(0.8)',\n  },\n  title: {\n    fontSize: 14,\n    fontWeight: '600'\n  },\n  pos: {\n    marginBottom: 12,\n    align: 'right',\n\n  },\n  FormContent: {\n    padding: '0.5rem 1rem',\n    marginBottom: '1rem',\n    borderRadius: '1rem',\n    width: '100%',\n    border: '1px solid rgb(228, 232, 239)',\n    color: 'rgb(80, 80, 80)',\n    boxShadow: 'rgb(0 0 0 / 4%) 0px 1px 6px inset',\n  },\n  disabledFormContent: {\n    padding: '0.5rem 1rem',\n    marginBottom: '1rem',\n    borderRadius: '1rem',\n    width: '100%',\n    border: '1px solid rgb(228, 232, 239)',\n    color: 'rgb(80, 80, 80)',\n    boxShadow: 'rgb(0 0 0 / 4%) 0px 1px 6px inset',\n    background: 'rgb(228, 232, 239)'\n  },\n  symbol: {\n    fontSize: '1.5rem'\n  },\n  max: {\n    display: 'inline',\n    opacity: '1',\n    lineHeight: '1rem',\n    color: 'rgb(96, 211, 162)',\n    cursor: 'pointer'\n  },\n  currencyInput: {\n    padding: '1rem 1rem 1rem 0px',\n    textAlign: 'right',\n    border: 'none',\n    fontSize: '1.5rem',\n    fontWeight: '400',\n    width: '100%',\n    boxSizing: 'border-box',\n    appearance: 'none',\n    outline: 'none',\n    \"&:focus\": {\n      outline: 'none !important',\n    }\n  },\n  swapButton: {\n    color: '#24947A',\n    borderColor: '#24947A',\n    borderRadius: '50px',\n    float: 'right',\n    width: '100px',\n    fontSize: '14px',\n    loading: ''\n  }\n}));\n\n\n\nexport default function CurrencyInputPanel() {\n  const classes = useStyles()\n\n  const provider = new ethers.providers.Web3Provider(window.ethereum)\n  const [ETHAmount, setETHAmount] = useState('');\n  const [SYCAmount, setSYCAmount] = useState('');\n  const [SYCPrice, setSYCPrice] = useState(0);\n  const [ETHPrice, setETHPrice] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [totoken, setTotoken] = useState(true);\n  const [approveAlready, setApproveAlready] = useState(false);\n  const [networkId, setNetworkId] = useState(0);\n\n  useEffect(() => {\n      async function getNetworkId() {\n          const provider = new ethers.providers.Web3Provider(window.ethereum)\n          const networkId = await provider.getNetwork()\n          setNetworkId(networkId.chainId) \n      }\n      async function getApproveState() {\n        const SycContract = new Contract(addresses[RINKEBY_ID].tokens.SYC, abis.erc20.abi, provider);\n        const account = await provider.listAccounts()\n        const approveState = await SycContract.allowance(account[0], addresses[RINKEBY_ID].implementation)\n\n        approveState.gte('5742700000000000000000000') ? setApproveAlready(true):setApproveAlready(false)\n      }\n      getNetworkId();\n      getApproveState();\n  }, [])\n\n\n\n  useEffect(() => {\n    const fetchPrice = async () => {\n      if (!isNaN(ETHAmount) && ETHAmount && totoken) {\n        setSYCAmount(await getPairAmount())\n      } else if (!isNaN(SYCAmount) && SYCAmount && !totoken) {\n        setETHAmount(await getPairAmount())\n      } else if (ETHAmount === '' || SYCAmount === '') {\n        setSYCAmount('');\n        setETHAmount('');\n      }\n    }\n    fetchPrice();\n  }, [ETHAmount, SYCAmount, totoken]);\n\n  useEffect(() => {\n    const getETHPrice = async () => {\n      const priceInfo = await axios.get('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT')\n      setETHPrice(priceInfo.data.price)\n    }\n    const getSYCPrice = async () => {\n      const SycWethExchangeContract = new Contract(addresses[RINKEBY_ID].pairs[\"SYC-WETH\"], abis.pair, provider);\n      const reserves = await SycWethExchangeContract.getReserves();\n      // reserves[0] is ETHER, reserves[1] is SYCoin\n      const k = reserves[0].mul(reserves[1])\n      if (totoken) {\n        const y = ethers.utils.parseUnits('0.997', \"ether\").add(reserves[0])\n        const x = ethers.utils.formatEther(reserves[1].sub(k.div(y)));\n        setSYCPrice(x.toString())\n      } else {\n        const y = ethers.utils.parseUnits('0.997', \"ether\").add(reserves[1])\n        const x = ethers.utils.formatEther(reserves[0].sub(k.div(y)));\n        setSYCPrice(x.toString())\n      }\n    }\n    getETHPrice();\n    getSYCPrice();\n  }, [totoken])\n\n\n  async function getPairAmount() {\n    try {\n\n      const SycWethExchangeContract = new Contract(addresses[RINKEBY_ID].pairs[\"SYC-WETH\"], abis.pair, provider);\n      const reserves = await SycWethExchangeContract.getReserves();\n      // reserves[0] is SYC, reserves[1] is ETHER\n      const k = reserves[0].mul(reserves[1])\n      let ETHAmountSubFee, SYCAmountSubFee, x, y;\n      // fee to dev 0.3%\n      if (totoken) {\n        ETHAmountSubFee = (parseFloat(ETHAmount) * 0.997).toString();\n        y = ethers.utils.parseUnits(ETHAmountSubFee, \"ether\").add(reserves[0])\n        x = ethers.utils.formatEther(reserves[1].sub(k.div(y)));\n\n      } else {\n        SYCAmountSubFee = (parseFloat(SYCAmount) * 0.997).toString();\n        y = ethers.utils.parseUnits(SYCAmountSubFee, \"ether\").add(reserves[1])\n        x = ethers.utils.formatEther(reserves[0].sub(k.div(y)));\n\n      }\n      return x.toString();\n\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  function changeDirection() {\n    setTotoken(!totoken);\n    setSYCAmount('');\n    setETHAmount('');\n  }\n\n\n  async function onSwap() {\n    try {\n      let tx;\n      setLoading(true);\n      const signer = provider.getSigner()\n      const implemetationContract = new Contract(addresses[RINKEBY_ID].implementation, abis.implemetation, signer);\n      if (totoken) {\n        tx = await implemetationContract.swapETHToSyc({ value: ethers.utils.parseEther(ETHAmount) });\n      } else {\n        tx = await implemetationContract.swapSycForETH(ethers.utils.parseEther(SYCAmount));\n      }\n      // until transactionHash is mined.\n      await provider.waitForTransaction(tx.hash);\n      setLoading(false);\n      console.log(tx);\n    } catch (err) {\n      console.log(err)\n    }\n    setLoading(false);\n  }\n\n  async function onApprove() {\n    try {\n      setLoading(true);\n      const signer = provider.getSigner()\n      const erc20Contract = new Contract(addresses[RINKEBY_ID].tokens.SYC, abis.erc20.abi, signer);\n      let tx = await erc20Contract.approve(\n        addresses[RINKEBY_ID].implementation,\n        '0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'\n      );\n      await provider.waitForTransaction(tx.hash);\n      setLoading(false);\n      setApproveAlready(true);\n    } catch (err) {\n      console.log(err)\n    }\n    setLoading(false);\n  }\n\n  async function onMax() {\n    const signer = provider.getSigner()\n    const account = await signer.getAddress()\n    const balance = await provider.getBalance(account)\n    setETHAmount(ethers.utils.formatEther(balance.toString()))\n  }\n\n\n  if (totoken) {\n    return (\n      <div>\n        <Container className={classes.container} maxWidth='lg'>\n          <Card className={classes.root}>\n            <CardContent className={classes.CardContent}>\n              <Grid container className={classes.GridContainer} spacing={10}>\n                <Grid item xs={12} sm={5}>\n                  <Card className={classes.FormContent}>\n                    <div style={{ display: \"flex\", justifyContent: 'space-between' }}>\n                      <Typography className={classes.title} color=\"textPrimary\">\n                        Amount\n                      </Typography>\n                      <Button className={classes.max} onClick={e => {onMax()}}>\n                        Max\n                      </Button>\n                    </div>\n                    <div style={{ display: \"flex\" }}>\n                    <input \n                    className={classes.currencyInput}\n                    placeholder=\"0\"\n                    onChange={e => setETHAmount(e.target.value)}\n                    value={ETHAmount}\n                    />\n                    <Button align='right' className={classes.symbol} display='inlign'>\n                      ETH\n                    </Button>\n                    </div>\n                    \n                    <Typography className={classes.pos} color=\"textSecondary\" align='right'>\n                      ~${(ETHPrice * ETHAmount).toFixed(2)}\n                    </Typography>\n                  </Card>\n                </Grid>\n                <Grid item xs={12} sm={2}>\n                  <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%'}}>\n                    <i \n                    className=\"fas fa-exchange-alt fa-2x\" \n                    onClick={e => changeDirection(false)}\n                    style={{cursor: 'pointer'}} />\n                  </div>\n                </Grid>\n                <Grid item xs={12} sm={5} style={{ cursor: 'not-allowed'}}>\n                <Card className={classes.disabledFormContent}>\n                    <div disabled style={{ display: \"flex\" }}>\n                      <Typography className={classes.title} color=\"textPrimary\">\n                      Amount to be received (estimated)\n                      </Typography>\n                    </div>\n                    <div style={{ display: \"flex\" }}>\n                    <input \n                    className={classes.currencyInput}\n                    disabled\n                    style={{cursor: 'not-allowed', background: 'rgb(228, 232, 239)'}}\n                    value={SYCAmount}\n                    />\n                    <Button align='right' className={classes.symbol} display='inlign'>\n                      SYC\n                    </Button>\n                    </div>\n                    <Typography className={classes.pos} color=\"textSecondary\" align='right'>\n                     {SYCAmount ? `${parseFloat(SYCAmount / ETHAmount).toFixed(3)} SYC per ETH`: '🤔 SYC per ETH'}\n                    </Typography>\n                  </Card>\n                </Grid>\n              </Grid>\n              <div style={{ 'marginRight': '0' }}>\n                <Button \n                  variant=\"outlined\" \n                  className={classes.swapButton}\n                  onClick={e => onSwap()}\n                  >\n                  {loading && <CircularProgress size={14} />}\n                  {!loading && 'SWAP'}   \n                </Button>\n              </div> \n            </CardContent>\n          </Card>\n        </Container>\n        \n      </div>\n    );\n  } else {\n    return (\n      <div>\n      <Container className={classes.container} maxWidth='lg'>\n        <Card className={classes.root}>\n          <CardContent className={classes.CardContent}>\n            <Grid container className={classes.GridContainer} spacing={10}>\n              <Grid item xs={12} sm={5}>\n                <Card className={classes.FormContent}>\n                  <div style={{ display: \"flex\", justifyContent: 'space-between' }}>\n                    <Typography className={classes.title} color=\"textPrimary\">\n                      Amount\n                    </Typography>\n                    <Button className={classes.max} onClick={e => {onMax()}}>\n                      Max\n                    </Button>\n                  </div>\n                  <div style={{ display: \"flex\" }}>\n                  <input \n                  className={classes.currencyInput}\n                  placeholder=\"0\"\n                  onChange={e => setSYCAmount(e.target.value)}\n                  value={SYCAmount}\n                  />\n                  <Button align='right' className={classes.symbol} display='inlign'>\n                    SYC\n                  </Button>\n                  </div>\n                  \n                  <Typography className={classes.pos} color=\"textSecondary\" align='right'>\n                    ~${ETHAmount ? `${(ETHAmount / SYCAmount * ETHPrice).toFixed(2)}`: '0.00'}\n                  </Typography>\n                </Card> \n              </Grid>\n              <Grid item xs={12} sm={2}>\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%'}}>\n                  <i \n                  className=\"fas fa-exchange-alt fa-2x\"\n                  onClick={e => changeDirection(false)}\n                  style={{cursor: 'pointer'}} />\n                </div>\n              </Grid>\n              <Grid item xs={12} sm={5} style={{ cursor: 'not-allowed'}}>\n              <Card className={classes.disabledFormContent}>\n                  <div disabled style={{ display: \"flex\" }}>\n                    <Typography className={classes.title} color=\"textPrimary\">\n                    Amount to be received (estimated)\n                    </Typography>\n                  </div>\n                  <div style={{ display: \"flex\" }}>\n                  <input \n                  className={classes.currencyInput}\n                  disabled\n                  style={{cursor: 'not-allowed', background: 'rgb(228, 232, 239)'}}\n                  value={ETHAmount}\n                  />\n                  <Button align='right' className={classes.symbol} display='inlign'>\n                    ETH\n                  </Button>\n                  </div>\n                  <Typography className={classes.pos} color=\"textSecondary\" align='right'>\n                  {ETHAmount ? `${parseFloat(ETHAmount / SYCAmount).toFixed(6)} ETH per SYC`: '🤔 ETH per SYC'}\n                  </Typography>\n                </Card>\n              </Grid>\n            </Grid>\n            <div style={{ marginRight: '0' }}>\n            <Button \n              variant=\"outlined\" \n              className={classes.swapButton}\n              onClick={e => onSwap()}\n              disabled={!approveAlready}\n              >SWAP\n            </Button>\n            <Button style={{ marginRight: '10px' }}\n              variant=\"outlined\" \n              className={classes.swapButton}\n              onClick={e => onApprove()}\n              disabled={approveAlready}\n              >Approve\n            </Button> \n            </div>\n          </CardContent>\n        </Card>\n      </Container>\n    </div>\n\n    )\n  }\n\n}"]},"metadata":{},"sourceType":"module"}