{"ast":null,"code":"var _jsxFileName = \"/Users/sychen/thesis-app/packages/react-app/src/components/PolicyInputPanel/index.js\";\nimport React, { useState, useEffect } from 'react';\nimport { ethers } from \"ethers\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport styled from 'styled-components';\nimport { RINKEBY_ID, addresses, abis } from \"@uniswap-v2-app/contracts\";\nimport Container from '@material-ui/core/Container';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Button from '@material-ui/core/Button';\nimport ipfs from '../../ipfs';\nconst useStyles = makeStyles(theme => ({\n  container: {\n    marginTop: \"20px\",\n    width: '800px',\n    marginLeft: 'auto',\n    marginRight: 'auto',\n    backgroundColor: 'white',\n    padding: '30px 30px 30px 30px',\n    borderRadius: '10px'\n  }\n}));\nexport default function PolicyInputPanel() {\n  const classes = useStyles();\n  const [loading, setLoading] = useState(false);\n  const [policyName, setPolicyName] = useState(0);\n  const [policyType, setpolicyType] = useState(0);\n  const [policyContent, setPolicyContent] = useState(0);\n  const [policyPremium, setPolicyPremium] = useState(0);\n  const [policyDuration, setPolicyDuration] = useState(0);\n  const [buffer, setBuffer] = useState('');\n  const [contentHash, setContentHash] = useState(''); // after today\n\n  const today = new Date().toISOString().split(\"T\")[0];\n\n  function dateToUnix(value) {\n    const date = new Date(value);\n    return date.getTime();\n  }\n\n  const captureFile = async event => {\n    console.log('capture file...');\n    event.preventDefault();\n    const file = event.target.files[0];\n    const reader = new window.FileReader();\n    reader.readAsArrayBuffer(file);\n\n    reader.onloadend = () => {\n      setBuffer(Buffer.from(reader.result));\n    }; // upload\n\n\n    let data = buffer;\n    console.log('Submit this: ', data);\n    const postResponse = await ipfs.add(data);\n    console.log(\"hash: \", postResponse['path']);\n    setContentHash(postResponse['path']);\n  };\n\n  async function createPolicy() {\n    try {\n      let tx;\n      setLoading(true);\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const policyFactoryContract = new Contract(addresses[RINKEBY_ID].policyFactory, abis.policyFactory, signer);\n      console.log(policyFactoryContract);\n      tx = await policyFactoryContract.createPolicy(policyName, policyType, policyContent, policyPremium, policyDuration); // until transactionHash is mined.\n\n      await provider.waitForTransaction(tx.hash);\n      setLoading(false);\n      console.log(tx);\n    } catch (err) {\n      console.log(err);\n    }\n\n    setLoading(false);\n  }\n\n  return /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    className: classes.container,\n    gutterBottom: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h6\",\n    gutterBottom: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }, \"Create Policy\"), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    id: \"policyName\",\n    name: \"policyName\",\n    label: \"policyName\",\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(InputLabel, {\n    id: \"policyType\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }\n  }, \"policyType\"), /*#__PURE__*/React.createElement(Select, {\n    labelId: \"policyType\",\n    id: \"policyType\",\n    value: policyType,\n    onChange: e => setpolicyType(e.target.value),\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"em\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, \"None\")), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"Cyper Insurance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }, \"Cyper Insurance\"), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"Health Insurance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }, \"Health Insurance\"), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"Investment Insurance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }\n  }, \"Investment Insurance\"), /*#__PURE__*/React.createElement(MenuItem, {\n    value: \"Auto Insurance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }, \"Auto Insurance\"))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    id: \"policyContent\",\n    name: \"policyContent\",\n    label: \"policyContent\",\n    value: contentHash,\n    disabled: true,\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    id: \"Policypremium\",\n    name: \"Policypremium\",\n    label: \"Policypremium\",\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    id: \"state\",\n    name: \"state\",\n    label: \"State/Province/Region\",\n    fullWidth: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    accept: \".pdf,.word\",\n    className: classes.input,\n    style: {\n      display: 'none'\n    },\n    id: \"raised-button-file\",\n    multiple: true,\n    onChange: e => captureFile(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"raised-button-file\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"raised\",\n    component: \"span\",\n    className: classes.button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 11\n    }\n  }, \"Upload content\"))))));\n}\n{\n  /* <div className=\"field\">\n     <label>Policy Name</label>\n     <input type=\"text\" placeholder=\"Policy Name\" onChange={e => setPolicyName(e.target.value)}/>\n  </div>\n  <div className=\"field\">\n     <label>Policy Type</label>\n     <select multiple=\"\" className=\"ui dropdown\" onChange={e => setpolicyType(e.target.value)}>\n     <option value=\"\">Select Type</option>\n     <option value=\"Cyper Insurance\">Cyper Insurance</option>\n     <option value=\"Health Insurance\">Health Insurance</option>\n     <option value=\"Investment Insurance\">Investment Insurance</option>\n     <option value=\"Auto Insurance\">Auto Insurance</option>\n     </select>\n  </div>\n                  <div className=\"field\">\n     <label>Policy Content</label>\n     <input type=\"text\" placeholder=\"Policy Content\" onChange={e => setPolicyContent(e.target.value)}/>\n  </div>\n  <div className=\"field\">\n     <label>Policy Premium</label>\n     <input type=\"number\" placeholder=\"Policy Premium\" onChange={e => setPolicyPremium(e.target.value)}/>\n  </div>\n  <div className=\"field\">\n     <label>Policy Duration</label>\n     <input type=\"date\" placeholder=\"Policy Duration\" min={today} onChange={e => setPolicyDuration(dateToUnix(e.target.value))}/>\n  </div>\n  <button \n     className=\"ui button right floated\"\n     onClick={createPolicy}>Create</button> */\n}","map":{"version":3,"sources":["/Users/sychen/thesis-app/packages/react-app/src/components/PolicyInputPanel/index.js"],"names":["React","useState","useEffect","ethers","Contract","styled","RINKEBY_ID","addresses","abis","Container","Typography","Grid","TextField","MenuItem","Select","makeStyles","InputLabel","Button","ipfs","useStyles","theme","container","marginTop","width","marginLeft","marginRight","backgroundColor","padding","borderRadius","PolicyInputPanel","classes","loading","setLoading","policyName","setPolicyName","policyType","setpolicyType","policyContent","setPolicyContent","policyPremium","setPolicyPremium","policyDuration","setPolicyDuration","buffer","setBuffer","contentHash","setContentHash","today","Date","toISOString","split","dateToUnix","value","date","getTime","captureFile","event","console","log","preventDefault","file","target","files","reader","window","FileReader","readAsArrayBuffer","onloadend","Buffer","from","result","data","postResponse","add","createPolicy","tx","provider","providers","Web3Provider","ethereum","signer","getSigner","policyFactoryContract","policyFactory","waitForTransaction","hash","err","e","input","display","button"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { ethers } from \"ethers\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport styled from 'styled-components';\nimport { RINKEBY_ID, addresses, abis } from \"@uniswap-v2-app/contracts\";\nimport Container from '@material-ui/core/Container';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Button from '@material-ui/core/Button';\nimport ipfs from '../../ipfs';\n\n\nconst useStyles = makeStyles((theme) => ({\n    container: {\n      marginTop: \"20px\",\n      width: '800px',\n      marginLeft: 'auto',\n      marginRight: 'auto',\n      backgroundColor: 'white',\n      padding: '30px 30px 30px 30px',\n      borderRadius: '10px'\n    },\n}));\n\n\nexport default function PolicyInputPanel() {\n    const classes = useStyles()\n\n    const [loading, setLoading] = useState(false);\n    const [policyName, setPolicyName] = useState(0);\n    const [policyType, setpolicyType] = useState(0);\n    const [policyContent, setPolicyContent] = useState(0);\n    const [policyPremium, setPolicyPremium] = useState(0);\n    const [policyDuration, setPolicyDuration] = useState(0);\n    const [buffer, setBuffer] = useState('');\n    const [contentHash, setContentHash] = useState('');\n\n    // after today\n    const today = new Date().toISOString().split(\"T\")[0];\n\n    function dateToUnix(value) {\n        const date = new Date(value);\n        return date.getTime();\n    }\n\n    const captureFile = async event => {\n      console.log('capture file...');\n      event.preventDefault();\n      const file = event.target.files[0];\n      const reader = new window.FileReader();\n      reader.readAsArrayBuffer(file);\n      reader.onloadend = () => {\n        setBuffer(Buffer.from(reader.result));\n      }\n      // upload\n      let data = buffer;\n      console.log('Submit this: ', data);\n      const postResponse = await ipfs.add(data);\n      console.log(\"hash: \", postResponse['path']);\n      setContentHash(postResponse['path']);\n    }\n\n\n    async function createPolicy() {\n        try {\n            let tx;\n            setLoading(true);\n            const provider = new ethers.providers.Web3Provider(window.ethereum);\n            const signer = provider.getSigner()\n            const policyFactoryContract = new Contract(addresses[RINKEBY_ID].policyFactory, abis.policyFactory, signer);\n            console.log(policyFactoryContract)\n            tx = await policyFactoryContract.createPolicy(\n                policyName,\n                policyType,\n                policyContent,\n                policyPremium,\n                policyDuration\n            );\n          // until transactionHash is mined.\n            await provider.waitForTransaction(tx.hash);\n            setLoading(false);\n            console.log(tx);\n            } catch (err) {\n            console.log(err)\n            }\n            setLoading(false);\n        }\n\n    return (\n     <Grid container className={classes.container} gutterBottom>\n     <React.Fragment>\n      <Typography variant=\"h6\" gutterBottom>\n        Create Policy\n      </Typography>\n      <Grid container spacing={3}>\n        <Grid item xs={12} sm={6}>\n          <TextField\n            required\n            id=\"policyName\"\n            name=\"policyName\"\n            label=\"policyName\"\n            fullWidth\n          />\n        </Grid>\n        <Grid item xs={12} sm={6}>\n            <InputLabel id=\"policyType\">policyType</InputLabel>\n            <Select\n            labelId=\"policyType\"\n            id=\"policyType\"\n            value={policyType}\n            onChange={e => setpolicyType(e.target.value)}\n            fullWidth\n            >\n            <MenuItem value=\"\">\n                <em>None</em>\n            </MenuItem>\n            <MenuItem value=\"Cyper Insurance\">Cyper Insurance</MenuItem>\n            <MenuItem value=\"Health Insurance\">Health Insurance</MenuItem>\n            <MenuItem value=\"Investment Insurance\">Investment Insurance</MenuItem>\n            <MenuItem value=\"Auto Insurance\">Auto Insurance</MenuItem>\n            </Select>\n        </Grid>\n        <Grid item xs={12}>\n          <TextField\n            required\n            id=\"policyContent\"\n            name=\"policyContent\"\n            label=\"policyContent\"\n            value={contentHash}\n            disabled\n            fullWidth\n          />\n        </Grid>\n        <Grid item xs={12} sm={6}>\n          <TextField\n            required\n            id=\"Policypremium\"\n            name=\"Policypremium\"\n            label=\"Policypremium\"\n            fullWidth\n          />\n        </Grid>\n        <Grid item xs={12} sm={6}>\n          <TextField id=\"state\" name=\"state\" label=\"State/Province/Region\" fullWidth />\n        </Grid>\n        <Grid>\n            <input\n              type=\"file\"\n              accept=\".pdf,.word\"\n              className={classes.input}\n              style={{ display: 'none', }}\n              id=\"raised-button-file\"\n              multiple\n              onChange={e => captureFile(e)}\n            />\n          <label htmlFor=\"raised-button-file\">\n          <Button variant=\"raised\" component=\"span\" className={classes.button}>\n            Upload content\n          </Button>\n          </label> \n      </Grid>\n      </Grid>\n    </React.Fragment>\n        </Grid>\n    )\n}\n\n\n\n                {/* <div className=\"field\">\n                    <label>Policy Name</label>\n                    <input type=\"text\" placeholder=\"Policy Name\" onChange={e => setPolicyName(e.target.value)}/>\n                </div>\n                <div className=\"field\">\n                    <label>Policy Type</label>\n                    <select multiple=\"\" className=\"ui dropdown\" onChange={e => setpolicyType(e.target.value)}>\n                    <option value=\"\">Select Type</option>\n                    <option value=\"Cyper Insurance\">Cyper Insurance</option>\n                    <option value=\"Health Insurance\">Health Insurance</option>\n                    <option value=\"Investment Insurance\">Investment Insurance</option>\n                    <option value=\"Auto Insurance\">Auto Insurance</option>\n                    </select>\n                </div>\n                \n                <div className=\"field\">\n                    <label>Policy Content</label>\n                    <input type=\"text\" placeholder=\"Policy Content\" onChange={e => setPolicyContent(e.target.value)}/>\n                </div>\n                <div className=\"field\">\n                    <label>Policy Premium</label>\n                    <input type=\"number\" placeholder=\"Policy Premium\" onChange={e => setPolicyPremium(e.target.value)}/>\n                </div>\n                <div className=\"field\">\n                    <label>Policy Duration</label>\n                    <input type=\"date\" placeholder=\"Policy Duration\" min={today} onChange={e => setPolicyDuration(dateToUnix(e.target.value))}/>\n                </div>\n                <button \n                    className=\"ui button right floated\"\n                    onClick={createPolicy}>Create</button> */}"]},"metadata":{},"sourceType":"module"}