{"ast":null,"code":"var _jsxFileName = \"/Users/sychen/thesis-app/packages/react-app/src/components/Pages/StakePage.js\";\nimport React, { useState, useEffect } from \"react\";\nimport Jumbotron from '../Jumbotron';\nimport styled from 'styled-components';\nimport { ethers } from \"ethers\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport { RINKEBY_ID, addresses, abis } from \"@uniswap-v2-app/contracts\";\nimport { Link as RouterLink } from 'react-router-dom';\nimport Link from \"@material-ui/core/Link\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Container from '@material-ui/core/Container';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nexport default function StakePage() {\n  const [policies, setPolicies] = useState(0);\n  useEffect(() => {\n    const getPolicies = async () => {\n      let policy, summary;\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const policyFactoryContract = new Contract(addresses[RINKEBY_ID].policyFactory, abis.policyFactory, provider);\n      const policies = await policyFactoryContract.getDeloyedPolicies();\n      console.log(policies);\n      const allPolicies = await Promise.all(policies.map((address, index) => {\n        policy = new Contract(address, abis.policy, provider);\n        return policy.getSummary();\n      }));\n      setPolicies(allPolicies);\n    };\n\n    getPolicies();\n  }, []);\n\n  function renderList(policies) {\n    if (policies == 0) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 20\n        }\n      }, \"Loading...\");\n    }\n\n    return Object.values(policies).map((element, idx) => {\n      console.log(element);\n      return /*#__PURE__*/React.createElement(Grid, {\n        key: idx,\n        item: true,\n        xs: 4,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Card, {\n        variant: \"outlined\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(CardContent, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Typography, {\n        color: \"textSecondary\",\n        gutterBottom: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(Typography, {\n        variant: \"h5\",\n        component: \"h2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 19\n        }\n      }, element[0]), /*#__PURE__*/React.createElement(Typography, {\n        color: \"textSecondary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: `https://ipfs.io/ipfs/${element[2]}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 19\n        }\n      }, \"Policy Content\")), /*#__PURE__*/React.createElement(Typography, {\n        color: \"textSecondary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 19\n        }\n      }, \"Insurance base: \", /*#__PURE__*/React.createElement(\"span\", {\n        style: {\n          float: 'right'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 37\n        }\n      }, element[1].toString() / 10 ** 18, \" Ether\")), /*#__PURE__*/React.createElement(Typography, {\n        color: \"textSecondary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 19\n        }\n      }, \"Stacked: \", /*#__PURE__*/React.createElement(\"span\", {\n        style: {\n          float: 'right'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 30\n        }\n      }, ethers.parseEther(element[3].toString()), \" SYC\"))), /*#__PURE__*/React.createElement(CardActions, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        component: RouterLink,\n        to: `/staking/${idx}`,\n        variant: \"contained\",\n        color: \"primary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 21\n        }\n      }, \"Stack\"), /*#__PURE__*/React.createElement(Button, {\n        component: RouterLink,\n        to: `/claims/${idx}`,\n        variant: \"contained\",\n        color: \"secondary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 21\n        }\n      }, \"Request\"))));\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Jumbotron, {\n    title: \"Stake\",\n    description: \"Earn rewards by staking SYC on policies you want to engage.\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Container, {\n    style: {\n      marginTop: \"20px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    style: {\n      marginTop: \"20px\"\n    },\n    spacing: 5,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }\n  }, renderList(policies))));\n}","map":{"version":3,"sources":["/Users/sychen/thesis-app/packages/react-app/src/components/Pages/StakePage.js"],"names":["React","useState","useEffect","Jumbotron","styled","ethers","Contract","RINKEBY_ID","addresses","abis","Link","RouterLink","makeStyles","Container","Card","CardActions","CardContent","Button","Typography","Grid","StakePage","policies","setPolicies","getPolicies","policy","summary","provider","providers","Web3Provider","window","ethereum","policyFactoryContract","policyFactory","getDeloyedPolicies","console","log","allPolicies","Promise","all","map","address","index","getSummary","renderList","Object","values","element","idx","float","toString","parseEther","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Jumbotron from '../Jumbotron';\nimport styled from 'styled-components';\nimport { ethers } from \"ethers\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport { RINKEBY_ID, addresses, abis } from \"@uniswap-v2-app/contracts\";\nimport { Link as RouterLink } from 'react-router-dom';\nimport Link from \"@material-ui/core/Link\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Container from '@material-ui/core/Container';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\n\n\nexport default function StakePage() {\n    const [policies, setPolicies] = useState(0);\n\n    useEffect(() => {\n        const getPolicies = async () => {\n            let policy, summary;\n            const provider = new ethers.providers.Web3Provider(window.ethereum);\n            const policyFactoryContract = new Contract(addresses[RINKEBY_ID].policyFactory, abis.policyFactory, provider);\n            const policies = await policyFactoryContract.getDeloyedPolicies();\n            console.log(policies)\n            const allPolicies = await Promise.all(\n                policies\n                    .map((address, index) => {\n                        policy = new Contract(address, abis.policy, provider);\n                        return policy.getSummary();\n                    }));\n\n            setPolicies(allPolicies);\n        }\n        getPolicies();\n    }, []);\n\n    function renderList(policies) {\n        if (policies == 0) {\n            return <div>Loading...</div>\n        }\n        return Object.values(policies).map((element, idx) => {\n            console.log(element)\n            return (\n                <Grid key={idx} item xs={4}>\n                    <Card variant=\"outlined\">\n                <CardContent>\n                  <Typography color=\"textSecondary\" gutterBottom>\n                  </Typography>\n                  <Typography variant=\"h5\" component=\"h2\">\n                    {element[0]}\n                  </Typography>\n                  <Typography color=\"textSecondary\">\n                  <a href={`https://ipfs.io/ipfs/${element[2]}`}>Policy Content</a>\n                  </Typography>\n                  <Typography color=\"textSecondary\">\n                    Insurance base: <span style={{float: 'right'}}>{element[1].toString() / 10**18} Ether</span>\n                  </Typography>\n                  <Typography color=\"textSecondary\">\n                    Stacked: <span style={{float: 'right'}}>{ethers.parseEther(element[3].toString())} SYC</span>\n                  </Typography>\n\n                </CardContent>\n                <CardActions>\n                    <Button component={ RouterLink } to={`/staking/${idx}`} variant=\"contained\" color=\"primary\">\n                        Stack\n                    </Button>\n                    <Button component={ RouterLink } to={`/claims/${idx}`} variant=\"contained\" color=\"secondary\">\n                        Request\n                    </Button>\n                </CardActions>\n              </Card>\n                </Grid>\n            \n            );\n        })\n\n    }\n\n\n    return (\n        <div>\n            <Jumbotron\n                title=\"Stake\"\n                description=\"Earn rewards by staking SYC on policies you want to engage.\" />\n            <Container style={{ marginTop: \"20px\" }}>\n                <Grid container style={{ marginTop: \"20px\" }} spacing={5}>\n                    {renderList(policies)}\n                </Grid>\n            </Container>\n\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}