{"ast":null,"code":"var _jsxFileName = \"/Users/sychen/thesis-app/packages/react-app/src/components/CurrencyInputPanel/index.js\";\nimport React, { useState, useEffect } from 'react';\nimport { RINKEBY_ID, addresses, abis } from \"@uniswap-v2-app/contracts\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport { ethers } from \"ethers\"; // import useWeb3Modal from \"../../hooks/useWeb3Modal\";\n\nimport { ChainId, Token, WETH, Fetcher, Route } from '@uniswap/sdk'; // const projectId = \"66fbccb2856b40b3a622d925568379e9\";\n// const projectSecret = \"275ed56f36e440e0ab7cad94a3310aae\";\n\nexport default function CurrencyInputPanel({\n  provider\n}) {\n  const [ETHAmount, setETHAmount] = useState(0);\n  const [SYCAmount, setSYCAmount] = useState(0);\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    const fetchPrice = async () => {\n      if (!isNaN(ETHAmount) && ETHAmount) {\n        setSYCAmount(await getPairAmount());\n      } else if (ETHAmount === '') {\n        setSYCAmount('');\n      }\n    };\n\n    fetchPrice();\n  }, [ETHAmount]);\n\n  async function getPairAmount() {\n    try {\n      const chainId = ChainId.RINKEBY;\n      const tokenAddress = addresses[RINKEBY_ID].tokens[\"SYC\"];\n      const syc = await Fetcher.fetchTokenData(chainId, tokenAddress);\n      const weth = addresses[RINKEBY_ID].tokens[\"WETH\"];\n      const pair = await Fetcher.fetchPairData(syc, weth);\n      const route = new Route([pair], weth);\n      console.log(route.midPrice.toSignificant(6)); // const SycWethExchangeContract = new Contract(addresses[RINKEBY_ID].pairs[\"SYC-WETH\"], abis.pair, provider);\n      // const reserves = await SycWethExchangeContract.getReserves();\n      // // reserves[0] is SYC, reserves[1] is ETHER\n      // const k = reserves[0].mul(reserves[1])\n      // // fee to dev 0.3%\n      // const ETHAmountSubFee = (parseFloat(ETHAmount) * 0.997).toString();\n      // const y = ethers.utils.parseUnits(ETHAmountSubFee, \"ether\").add(reserves[1])\n      // const x = ethers.utils.formatEther(reserves[0].sub(k.div(y)))\n      // return x.toString();\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async function onSwap() {\n    try {\n      setLoading(true);\n      const signer = provider.getSigner();\n      const implemetationContract = new Contract(addresses[RINKEBY_ID].implementation, abis.implemetation, signer);\n      let tx = await implemetationContract.swapETHToSyc({\n        value: ethers.utils.parseEther(ETHAmount)\n      });\n      setLoading(false);\n      console.log(tx);\n    } catch (err) {\n      console.log(err);\n    }\n\n    setLoading(false);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ui container\",\n    style: {\n      marginTop: \"20px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ui big form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ui grid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"field six wide column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 15\n    }\n  }, \"Amount\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ui right labeled input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    onChange: e => setETHAmount(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"ui dropdown label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 19\n    }\n  }, \"ETH\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"field four wide column center aligned\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-exchange-alt fa-2x\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"field six wide column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 15\n    }\n  }, \"Amount to be received (estimated)\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ui right labeled input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    disabled: \"disabled\",\n    value: SYCAmount,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"ui dropdown label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 19\n    }\n  }, \"SYC\"))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: `ui submit button right floated ${loading ? 'loading' : ''}`,\n    onClick: onSwap,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  }, \"Swap\"))));\n}","map":{"version":3,"sources":["/Users/sychen/thesis-app/packages/react-app/src/components/CurrencyInputPanel/index.js"],"names":["React","useState","useEffect","RINKEBY_ID","addresses","abis","Contract","ethers","ChainId","Token","WETH","Fetcher","Route","CurrencyInputPanel","provider","ETHAmount","setETHAmount","SYCAmount","setSYCAmount","loading","setLoading","fetchPrice","isNaN","getPairAmount","chainId","RINKEBY","tokenAddress","tokens","syc","fetchTokenData","weth","pair","fetchPairData","route","console","log","midPrice","toSignificant","err","onSwap","signer","getSigner","implemetationContract","implementation","implemetation","tx","swapETHToSyc","value","utils","parseEther","marginTop","e","target"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { RINKEBY_ID, addresses, abis } from \"@uniswap-v2-app/contracts\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport { ethers } from \"ethers\";\n// import useWeb3Modal from \"../../hooks/useWeb3Modal\";\nimport { ChainId, Token, WETH, Fetcher, Route } from '@uniswap/sdk'\n\n// const projectId = \"66fbccb2856b40b3a622d925568379e9\";\n// const projectSecret = \"275ed56f36e440e0ab7cad94a3310aae\";\n\nexport default function CurrencyInputPanel({ provider }) {\n  const [ETHAmount, setETHAmount] = useState(0);\n  const [SYCAmount, setSYCAmount] = useState(0);\n  const [loading, setLoading] = useState(false);\n\n\n  useEffect(() => {\n    const fetchPrice = async () => {\n      if (!isNaN(ETHAmount) && ETHAmount) {\n        setSYCAmount(await getPairAmount())\n      } else if (ETHAmount === '') {\n        setSYCAmount('');\n      }\n    }\n    fetchPrice();\n  }, [ETHAmount]);\n\n\n  async function getPairAmount() {\n    try {\n      const chainId = ChainId.RINKEBY;\n      const tokenAddress = addresses[RINKEBY_ID].tokens[\"SYC\"];\n      const syc = await Fetcher.fetchTokenData(chainId, tokenAddress);\n      const weth = addresses[RINKEBY_ID].tokens[\"WETH\"];\n      const pair = await Fetcher.fetchPairData(syc, weth);\n      const route = new Route([pair], weth);\n      console.log(route.midPrice.toSignificant(6));\n      // const SycWethExchangeContract = new Contract(addresses[RINKEBY_ID].pairs[\"SYC-WETH\"], abis.pair, provider);\n      // const reserves = await SycWethExchangeContract.getReserves();\n      // // reserves[0] is SYC, reserves[1] is ETHER\n      // const k = reserves[0].mul(reserves[1])\n      // // fee to dev 0.3%\n      // const ETHAmountSubFee = (parseFloat(ETHAmount) * 0.997).toString();\n      // const y = ethers.utils.parseUnits(ETHAmountSubFee, \"ether\").add(reserves[1])\n      // const x = ethers.utils.formatEther(reserves[0].sub(k.div(y)))\n      \n      // return x.toString();\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n\n  async function onSwap() {\n    try {\n      setLoading(true);\n      const signer = provider.getSigner()\n      const implemetationContract = new Contract(addresses[RINKEBY_ID].implementation, abis.implemetation, signer);\n      let tx = await implemetationContract.swapETHToSyc({ value: ethers.utils.parseEther(ETHAmount) });\n      setLoading(false);\n      console.log(tx);\n    } catch (err) {\n      console.log(err)\n    }\n    setLoading(false);\n  }\n\n\n  return (\n    <div>\n      <div className=\"ui container\" style={{ marginTop: \"20px\" }}>\n        <div className=\"ui big form\">\n          <div className=\"ui grid\">\n            <div className=\"field six wide column\">\n              <label>Amount</label>\n              <div className=\"ui right labeled input\">\n                <input type=\"text\" onChange={e => setETHAmount(e.target.value)} />\n                <div class=\"ui dropdown label\">\n                  <div class=\"text\">ETH</div>\n                </div>\n              </div>\n            </div>\n            <div className=\"field four wide column center aligned\">\n              <i className=\"fas fa-exchange-alt fa-2x\"></i>\n            </div>\n            <div className=\"field six wide column\">\n              <label>Amount to be received (estimated)</label>\n              <div className=\"ui right labeled input\">\n                <input type=\"text\" disabled=\"disabled\" value={SYCAmount} />\n                <div class=\"ui dropdown label\">\n                  <div class=\"text\">SYC</div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className={`ui submit button right floated ${loading ? 'loading' : ''}`} onClick={onSwap}>Swap</div>\n        </div>\n      </div>\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}